#pragma once
#include <torch/torch.h>
#include "info.h"
#include "action.h"

class TensorConverter {
public:
    // 4 (Hole Cards) + 10 (Board) + 6 (Game State) = 20 Floats
    static constexpr const int INPUT_SIZE = 20; 

    // Converts the game state (Info) into a [1, 20] Tensor for the NN
    static torch::Tensor infoToTensor(const Info& info);

    // Converts an existing Action (from AISmart) into a Target Vector (x, y)
    // Used for Imitation Learning (Training Phase)
    static torch::Tensor actionToTarget(const Action& action, const Info& info);

    // Converts the NN's Output Vector (x, y) back into a valid Poker Action
    // Used for Gameplay (Inference Phase)
    static Action vectorToAction(const Info& info, float x, float y);

private:
    // Helper to normalize card ranks (2-14 -> 0-1) and suits (0-3 -> 0-1)
    static void encodeCard(const Card& c, std::vector<float>& features);
    static void encodeEmptyCard(std::vector<float>& features);
};
